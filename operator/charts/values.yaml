# NOTE: The helmValues struct in operator/e2e/setup/grove.go generates values for this chart.
# Keep both in sync when modifying.

# ReplicaCount is the value for spec.replicas for the grove-operator deployment resource.
replicaCount: 1

# This sets the container image more information can be found here: https://kubernetes.io/docs/concepts/containers/images/
image:
  repository: grove-operator
  # Overrides the image tag whose default is the chart appVersion.
  tag: v0.1.0-dev
  # This sets the pull policy for images.
  pullPolicy: IfNotPresent

resources:
  limits:
    memory: 1Gi
  requests:
    cpu: 50m
    memory: 128Mi
    ephemeral-storage: 128Mi

# Set of tolerations to apply to the operator deployment.
tolerations: [ ]

# This section builds out the service account more information can be found here: https://kubernetes.io/docs/concepts/security/service-accounts/
serviceAccount:
  # Automatically mount a ServiceAccount's API credentials?
  automount: false
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: "grove-operator"
  labels:
    app.kubernetes.io/component: operator-serviceaccount
    app.kubernetes.io/name: grove-operator-service-account
    app.kubernetes.io/part-of: grove

config:
  runtimeClientConnection:
    qps: 100
    burst: 150
  leaderElection:
    enabled: true
    leaseDuration: 15s
    renewDeadline: 10s
    retryPeriod: 2s
    resourceLock: leases
    resourceName: grove-operator-leader-election
  server:
    webhooks:
      # NOTE to mantainers: If you change this default value, also update DefaultWebhookPort in operator/e2e/setup/constants.go
      port: 9443
      # serverCertDir is the directory path where certificate files are located.
      # The operator will look for tls.crt and tls.key in this directory.
      # NOTE to maintainers: If you change this, also update DefaultWebhookServerCertDir in operator/e2e/setup/constants.go
      serverCertDir: /etc/grove-operator/webhook-certs
      # secretName is the name of the Kubernetes Secret containing webhook certificates.
      # The Secret must contain tls.crt, tls.key, and ca.crt.
      # Default: "grove-webhook-server-cert"
      secretName: "grove-webhook-server-cert"
      # certProvisionMode controls how webhook certificates are provisioned.
      # Values:
      #   "auto" (default): cert-controller automatically generates self-signed certificates.
      #     - Best for development/testing
      #     - No manual certificate management needed
      #     - Certificates auto-rotate before expiry
      #   "manual": certificates must be provided externally (e.g., cert-manager, cluster admin).
      #     - Best for production
      #     - Use your own CA or Let's Encrypt
      #     - Requires Secret to exist before operator starts
      certProvisionMode: auto
    healthProbes:
      enable: false
      port: 9444
    metrics:
      port: 9445
  debugging:
    enableProfiling: false
  controllers:
    podCliqueSet:
      concurrentSyncs: 3
    podClique:
      concurrentSyncs: 3
  logLevel: info
  logFormat: json
  topologyAwareScheduling:
    enabled: false
    #    levels:
    #      - domain: zone
    #        key: topology.kubernetes.io/zone
    #      - domain: datacenter
    #        key: <provider-specific-datacenter-node-label-key>
    #      - domain: block
    #        key: <provider-specific-block-node-label-key>
    #      - domain: rack
    #        key: <provider-specific-rack-node-label-key>
    #      - domain: host
    #        key: kubernetes.io/hostname
    #      - domain: region
    #        key: topology.kubernetes.io/region
    #      - domain: numa
    #        key: <provider-specific-numa-node-label-key>
  authorizer:
    enabled: false
    exemptServiceAccountUserNames:
      - system:serviceaccount:kube-system:generic-garbage-collector
      - system:serviceaccount:kube-system:horizontal-pod-autoscaler
      - system:kube-controller-manager
      - system:serviceaccount:kai-scheduler:pod-grouper
      - system:serviceaccount:kai-scheduler:binder
  network:
    autoMNNVLEnabled: false

configMap:
  labels:
    app.kubernetes.io/component: operator-configmap
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

deployment:
  labels:
    app.kubernetes.io/component: operator-deployment
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove
  env:
    - name: GROVE_INIT_CONTAINER_IMAGE
      value: grove-initc

# This is for setting up a service more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/
service:
  # NOTE: If you are going to change the service name then ensure that SAN entries in the webhook certificate also reflect the change.
  name: grove-operator
  # This sets the service type more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types
  type: ClusterIP
  # This sets the ports more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#field-spec-ports
  port: 80
  labels:
    app.kubernetes.io/component: operator-service
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

clusterRole:
  name: grove:system:grove-operator
  labels:
    app.kubernetes.io/component: operator-clusterrole
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

clusterRoleBinding:
  name: grove:system:grove-operator
  labels:
    app.kubernetes.io/component: operator-clusterrolebinding
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

leaseRole:
  name: grove:system:grove-operator-lease
  labels:
    app.kubernetes.io/component: operator-lease-role
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

leaseRoleBinding:
  name: grove:system:grove-operator-lease
  labels:
    app.kubernetes.io/component: operator-lease-rolebinding
    app.kubernetes.io/name: grove-operator
    app.kubernetes.io/part-of: grove

webhooks:
  # Shared CA bundle for all webhooks. This is the base64-encoded CA certificate
  # that signed the webhook server's TLS certificate.
  caBundle: ""
  podCliqueSetValidationWebhook:
    labels:
      app.kubernetes.io/component: operator-pcs-validating-webhook
      app.kubernetes.io/name: pcs-validating-webhook
      app.kubernetes.io/part-of: grove
    annotations: {}
  podCliqueSetDefaultingWebhook:
    labels:
      app.kubernetes.io/component: operator-pcs-defaulting-webhook
      app.kubernetes.io/name: pcs-defaulting-webhook
      app.kubernetes.io/part-of: grove
    annotations: {}
  authorizerWebhook:
    labels:
      app.kubernetes.io/component: operator-authorizer-webhook
      app.kubernetes.io/name: authorizer-webhook
      app.kubernetes.io/part-of: grove
    annotations: {}

webhookServerSecret:
  labels:
    app.kubernetes.io/component: operator-webhook-server-secret
    app.kubernetes.io/name: grove-webhook-server-secret
    app.kubernetes.io/part-of: grove

priorityClass:
  enabled: false
  name: grove-operator-priority-critical
  value: 999999550

